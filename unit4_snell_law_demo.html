<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snellå®šå¾‹ - å…‰çš„æŠ˜å°„äº’å‹•æ•™å­¸</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        h3 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 1em;
        }
        
        .main-content {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }
        
        .diagram-section {
            flex: 2;
            min-width: 400px;
        }
        
        .controls-section {
            flex: 1;
            min-width: 300px;
        }
        
        .diagram-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #e9ecef;
        }
        
        canvas {
            width: 100%;
            height: 500px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: linear-gradient(to bottom, #87CEEB 0%, #87CEEB 50%, #F0F8FF 50%, #F0F8FF 100%);
        }
        
        .controls {
            background: #e8f4f8;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #3498db;
        }
        
        .control-group {
            margin: 20px 0;
        }
        
        .control-row {
            display: flex;
            align-items: center;
            margin: 15px 0;
        }
        
        label {
            font-weight: bold;
            color: #2c3e50;
            min-width: 120px;
        }
        
        input[type="range"] {
            flex: 1;
            margin: 0 15px;
        }
        
        .value-display {
            background: #3498db;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
            min-width: 60px;
            text-align: center;
        }
        
        .formula-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #f39c12;
            text-align: center;
        }
        
        .formula {
            font-size: 1.5em;
            font-weight: bold;
            color: #2c3e50;
            margin: 10px 0;
        }
        
        .calculation-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #28a745;
        }
        
        .info-box {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            border-left: 5px solid #dc3545;
        }
        
        .concept-explanation {
            background: #e1ecf4;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #17a2b8;
        }
        
        .material-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 10px 0;
        }
        
        .material-btn {
            padding: 8px 15px;
            border: 2px solid #3498db;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .material-btn.active {
            background: #3498db;
            color: white;
        }
        
        .material-btn:hover {
            background: #2980b9;
            color: white;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .diagram-section, .controls-section {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒˆ Snellå®šå¾‹ - å…‰çš„æŠ˜å°„åŸç†</h1>
        <h3> ä½œè€…ï¼šäºæ±ç§‘æŠ€å¤§å­¸é€šè¨Šå·¥ç¨‹ç³» é™³ä¿Šå®</h3>
        <div class="concept-explanation">
            <h2>ğŸ“š ä»€éº¼æ˜¯Snellå®šå¾‹ï¼Ÿ</h2>
            <p><strong>Snellå®šå¾‹</strong>æè¿°å…‰ç·šå¾ä¸€ç¨®ä»‹è³ªé€²å…¥å¦ä¸€ç¨®ä»‹è³ªæ™‚ï¼Œå…¥å°„è§’å’ŒæŠ˜å°„è§’çš„æ•¸å­¸é—œä¿‚ã€‚</p>
            <p>ç•¶å…‰ç·šç©¿è¶Šä¸åŒå¯†åº¦çš„ä»‹è³ªæ™‚ï¼Œæœƒç™¼ç”Ÿ<strong>æŠ˜å°„ç¾è±¡</strong>ï¼Œå…‰ç·šæ–¹å‘æœƒæ”¹è®Šã€‚</p>
        </div>
        
        <div class="formula-box">
            <div class="formula">nâ‚ sin Î¸â‚ = nâ‚‚ sin Î¸â‚‚</div>
            <p>nâ‚, nâ‚‚ = å…©ç¨®ä»‹è³ªçš„æŠ˜å°„ç‡ã€€ï½œã€€Î¸â‚ = å…¥å°„è§’ã€€ï½œã€€Î¸â‚‚ = æŠ˜å°„è§’</p>
        </div>
        
        <div class="main-content">
            <div class="diagram-section">
                <div class="diagram-container">
                    <h3>ğŸ“Š å…‰ç·šæŠ˜å°„ç¤ºæ„åœ–</h3>
                    <canvas id="refractionCanvas" width="600" height="500"></canvas>
                </div>
            </div>
            
            <div class="controls-section">
                <div class="controls">
                    <h3>ğŸ›ï¸ èª¿æ•´åƒæ•¸</h3>
                    
                    <div class="control-group">
                        <label>å…¥å°„è§’ Î¸â‚:</label>
                        <div class="control-row">
                            <input type="range" id="incidentAngleSlider" min="0" max="89" value="30" step="1">
                            <span class="value-display" id="incidentAngleValue">30Â°</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label>ä»‹è³ª1 (ä¸Šæ–¹):</label>
                        <div class="material-selector">
                            <button class="material-btn active" data-n1="1.00" data-name="ç©ºæ°£">ç©ºæ°£</button>
                            <button class="material-btn" data-n1="1.33" data-name="æ°´">æ°´</button>
                            <button class="material-btn" data-n1="1.52" data-name="ç»ç’ƒ">ç»ç’ƒ</button>
                            <button class="material-btn" data-n1="custom" data-name="è‡ªå®šç¾©">è‡ªå®šç¾©</button>
                        </div>
                        <div class="control-row">
                            <label>æŠ˜å°„ç‡ nâ‚:</label>
                            <input type="number" id="n1Custom" min="1.00" max="2.00" step="0.01" value="1.00" 
                                   style="display: none; padding: 5px; border: 1px solid #ddd; border-radius: 5px; width: 80px; margin-right: 10px;">
                            <span class="value-display" id="n1Value">1.00</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label>ä»‹è³ª2 (ä¸‹æ–¹):</label>
                        <div class="material-selector">
                            <button class="material-btn" data-n2="1.00" data-name="ç©ºæ°£">ç©ºæ°£</button>
                            <button class="material-btn active" data-n2="1.33" data-name="æ°´">æ°´</button>
                            <button class="material-btn" data-n2="1.52" data-name="ç»ç’ƒ">ç»ç’ƒ</button>
                            <button class="material-btn" data-n2="2.42" data-name="é‘½çŸ³">é‘½çŸ³</button>
                            <button class="material-btn" data-n2="custom" data-name="è‡ªå®šç¾©">è‡ªå®šç¾©</button>
                        </div>
                        <div class="control-row">
                            <label>æŠ˜å°„ç‡ nâ‚‚:</label>
                            <input type="number" id="n2Custom" min="1.00" max="2.00" step="0.01" value="1.33" 
                                   style="display: none; padding: 5px; border: 1px solid #ddd; border-radius: 5px; width: 80px; margin-right: 10px;">
                            <span class="value-display" id="n2Value">1.33</span>
                        </div>
                    </div>
                </div>
                
                <div class="calculation-box">
                    <h3>ğŸ§® è¨ˆç®—çµæœ</h3>
                    <p><strong>æŠ˜å°„è§’ Î¸â‚‚ = <span id="refractionAngle">22.1Â°</span></strong></p>
                    <p>sin Î¸â‚ = <span id="sinTheta1">0.500</span></p>
                    <p>sin Î¸â‚‚ = <span id="sinTheta2">0.376</span></p>
                    <p>nâ‚ sin Î¸â‚ = <span id="leftSide">0.500</span></p>
                    <p>nâ‚‚ sin Î¸â‚‚ = <span id="rightSide">0.500</span></p>
                </div>
                
                <div class="info-box" id="criticalAngleInfo" style="display: none;">
                    <h3>âš ï¸ å…¨åå°„ç¾è±¡</h3>
                    <p>ç•¶å…¥å°„è§’å¤§æ–¼è‡¨ç•Œè§’æ™‚ï¼Œå…‰ç·šç„¡æ³•é€²å…¥ç¬¬äºŒä»‹è³ªï¼Œæœƒç™¼ç”Ÿå…¨åå°„ã€‚</p>
                    <p>è‡¨ç•Œè§’ Î¸c = <span id="criticalAngle">48.6Â°</span></p>
                </div>
            </div>
        </div>
        
        <div class="concept-explanation">
            <h3>ğŸ’¡ é‡è¦æ¦‚å¿µ</h3>
            <h4>ğŸ” æŠ˜å°„ç¾è±¡çš„åŸç†ï¼š</h4>
            <ul>
                <li><strong>å…‰é€Ÿè®ŠåŒ–</strong>ï¼šå…‰åœ¨ä¸åŒä»‹è³ªä¸­çš„å‚³æ’­é€Ÿåº¦ä¸åŒ</li>
                <li><strong>æ–¹å‘æ”¹è®Š</strong>ï¼šç•¶å…‰é€Ÿæ”¹è®Šæ™‚ï¼Œå…‰ç·šæ–¹å‘ä¹Ÿæœƒæ”¹è®Š</li>
                <li><strong>æŠ˜å°„ç‡</strong>ï¼šn = c/vï¼ˆçœŸç©ºä¸­å…‰é€Ÿ/ä»‹è³ªä¸­å…‰é€Ÿï¼‰</li>
            </ul>
            
            <h4>ğŸ“ è§’åº¦æ¸¬é‡ï¼š</h4>
            <ul>
                <li><strong>å…¥å°„è§’</strong>ï¼šå…¥å°„å…‰ç·šèˆ‡æ³•ç·šçš„å¤¾è§’</li>
                <li><strong>æŠ˜å°„è§’</strong>ï¼šæŠ˜å°„å…‰ç·šèˆ‡æ³•ç·šçš„å¤¾è§’</li>
                <li><strong>æ³•ç·š</strong>ï¼šå‚ç›´æ–¼ç•Œé¢çš„ç›´ç·š</li>
            </ul>
            
            <h4>ğŸŒŸ å¯¦éš›æ‡‰ç”¨ï¼š</h4>
            <ul>
                <li><strong>é€é¡è¨­è¨ˆ</strong>ï¼šç›¸æ©Ÿã€çœ¼é¡ã€é¡¯å¾®é¡</li>
                <li><strong>å…‰çº–é€šè¨Š</strong>ï¼šåˆ©ç”¨å…¨åå°„åŸç†</li>
                <li><strong>å½©è™¹ç¾è±¡</strong>ï¼šæ°´æ»´ä¸­çš„å…‰ç·šæŠ˜å°„å’Œåå°„</li>
            </ul>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('refractionCanvas');
        const ctx = canvas.getContext('2d');
        const incidentAngleSlider = document.getElementById('incidentAngleSlider');
        const incidentAngleValue = document.getElementById('incidentAngleValue');
        const n1Value = document.getElementById('n1Value');
        const n2Value = document.getElementById('n2Value');
        const n1Custom = document.getElementById('n1Custom');
        const n2Custom = document.getElementById('n2Custom');
        const refractionAngle = document.getElementById('refractionAngle');
        const sinTheta1 = document.getElementById('sinTheta1');
        const sinTheta2 = document.getElementById('sinTheta2');
        const leftSide = document.getElementById('leftSide');
        const rightSide = document.getElementById('rightSide');
        const criticalAngleInfo = document.getElementById('criticalAngleInfo');
        const criticalAngle = document.getElementById('criticalAngle');
        
        let n1 = 1.00; // ç©ºæ°£
        let n2 = 1.33; // æ°´
        let incidentAngle = 30;
        let n1IsCustom = false;
        let n2IsCustom = false;
        
        function drawRefraction() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const rayLength = 150;
            
            // ç¹ªè£½ç•Œé¢
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(canvas.width, centerY);
            ctx.stroke();
            
            // ç¹ªè£½æ³•ç·š
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(centerX, centerY - rayLength - 50);
            ctx.lineTo(centerX, centerY + rayLength + 50);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // è¨ˆç®—è§’åº¦ï¼ˆè½‰æ›ç‚ºå¼§åº¦ï¼‰
            const theta1Rad = (incidentAngle * Math.PI) / 180;
            const sinTheta1Val = Math.sin(theta1Rad);
            
            // ä½¿ç”¨Snellå®šå¾‹è¨ˆç®—æŠ˜å°„è§’
            const sinTheta2Val = (n1 * sinTheta1Val) / n2;
            let theta2Rad = 0;
            let totalInternalReflection = false;
            
            if (sinTheta2Val > 1) {
                // å…¨åå°„
                totalInternalReflection = true;
                theta2Rad = Math.asin(1); // 90åº¦
            } else {
                theta2Rad = Math.asin(sinTheta2Val);
            }
            
            const theta2Deg = (theta2Rad * 180) / Math.PI;
            
            // ç¹ªè£½å…¥å°„å…‰ç·š
            const incidentEndX = centerX - rayLength * Math.sin(theta1Rad);
            const incidentEndY = centerY - rayLength * Math.cos(theta1Rad);
            
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(incidentEndX, incidentEndY);
            ctx.lineTo(centerX, centerY);
            ctx.stroke();
            
            // ç¹ªè£½ç®­é ­ï¼ˆå…¥å°„å…‰ç·šï¼‰
            drawArrow(ctx, incidentEndX, incidentEndY, centerX, centerY, '#e74c3c');
            
            if (!totalInternalReflection) {
                // ç¹ªè£½æŠ˜å°„å…‰ç·š
                const refractedEndX = centerX + rayLength * Math.sin(theta2Rad);
                const refractedEndY = centerY + rayLength * Math.cos(theta2Rad);
                
                ctx.strokeStyle = '#27ae60';
                ctx.lineWidth = 4;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(refractedEndX, refractedEndY);
                ctx.stroke();
                
                // ç¹ªè£½ç®­é ­ï¼ˆæŠ˜å°„å…‰ç·šï¼‰
                drawArrow(ctx, centerX, centerY, refractedEndX, refractedEndY, '#27ae60');
            } else {
                // ç¹ªè£½åå°„å…‰ç·š
                const reflectedEndX = centerX + rayLength * Math.sin(theta1Rad);
                const reflectedEndY = centerY - rayLength * Math.cos(theta1Rad);
                
                ctx.strokeStyle = '#9b59b6';
                ctx.lineWidth = 4;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(reflectedEndX, reflectedEndY);
                ctx.stroke();
                
                // ç¹ªè£½ç®­é ­ï¼ˆåå°„å…‰ç·šï¼‰
                drawArrow(ctx, centerX, centerY, reflectedEndX, reflectedEndY, '#9b59b6');
            }
            
            // ç¹ªè£½è§’åº¦å¼§ç·š
            drawAngleArc(ctx, centerX, centerY, theta1Rad, 60, '#e74c3c', true);
            if (!totalInternalReflection) {
                drawAngleArc(ctx, centerX, centerY, theta2Rad, 80, '#27ae60', false);
            }
            
            // æ·»åŠ æ¨™ç±¤
            ctx.fillStyle = '#2c3e50';
            ctx.font = 'bold 16px Microsoft JhengHei';
            ctx.textAlign = 'center';
            
            // ä»‹è³ªæ¨™ç±¤
            ctx.fillText(`ä»‹è³ª 1 (nâ‚ = ${n1.toFixed(2)})`, centerX, 30);
            ctx.fillText(`ä»‹è³ª 2 (nâ‚‚ = ${n2.toFixed(2)})`, centerX, canvas.height - 15);
            
            // è§’åº¦æ¨™ç±¤
            ctx.fillStyle = '#e74c3c';
            ctx.fillText(`Î¸â‚ = ${incidentAngle}Â°`, centerX - 80, centerY - 40);
            
            if (!totalInternalReflection) {
                ctx.fillStyle = '#27ae60';
                ctx.fillText(`Î¸â‚‚ = ${theta2Deg.toFixed(1)}Â°`, centerX + 80, centerY + 60);
            } else {
                ctx.fillStyle = '#9b59b6';
                ctx.fillText('å…¨åå°„', centerX + 80, centerY - 40);
            }
            
            // æ³•ç·šæ¨™ç±¤
            ctx.fillStyle = '#666';
            ctx.font = '14px Microsoft JhengHei';
            ctx.fillText('æ³•ç·š', centerX + 15, centerY - 100);
            
            // æ›´æ–°è¨ˆç®—çµæœ
            updateCalculations(sinTheta1Val, sinTheta2Val, theta2Deg, totalInternalReflection);
        }
        
        function drawArrow(ctx, fromX, fromY, toX, toY, color) {
            const headlen = 15;
            const dx = toX - fromX;
            const dy = toY - fromY;
            const angle = Math.atan2(dy, dx);
            
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.moveTo(toX, toY);
            ctx.lineTo(toX - headlen * Math.cos(angle - Math.PI / 6), toY - headlen * Math.sin(angle - Math.PI / 6));
            ctx.lineTo(toX - headlen * Math.cos(angle + Math.PI / 6), toY - headlen * Math.sin(angle + Math.PI / 6));
            ctx.closePath();
            ctx.fill();
        }
        
        function drawAngleArc(ctx, centerX, centerY, angle, radius, color, isIncident) {
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            if (isIncident) {
                ctx.arc(centerX, centerY, radius, -Math.PI/2 - angle, -Math.PI/2);
            } else {
                ctx.arc(centerX, centerY, radius, Math.PI/2, Math.PI/2 + angle);
            }
            ctx.stroke();
        }
        
        function updateCalculations(sinTheta1Val, sinTheta2Val, theta2Deg, totalInternalReflection) {
            incidentAngleValue.textContent = incidentAngle + 'Â°';
            
            if (!totalInternalReflection) {
                refractionAngle.textContent = theta2Deg.toFixed(1) + 'Â°';
                sinTheta1.textContent = sinTheta1Val.toFixed(3);
                sinTheta2.textContent = sinTheta2Val.toFixed(3);
                leftSide.textContent = (n1 * sinTheta1Val).toFixed(3);
                rightSide.textContent = (n2 * sinTheta2Val).toFixed(3);
            } else {
                refractionAngle.textContent = 'å…¨åå°„';
                sinTheta1.textContent = sinTheta1Val.toFixed(3);
                sinTheta2.textContent = 'ç„¡æŠ˜å°„';
                leftSide.textContent = (n1 * sinTheta1Val).toFixed(3);
                rightSide.textContent = '> ' + n2.toFixed(2);
            }
            
            // æª¢æŸ¥æ˜¯å¦éœ€è¦é¡¯ç¤ºè‡¨ç•Œè§’ä¿¡æ¯
            if (n1 > n2) {
                const criticalAngleRad = Math.asin(n2 / n1);
                const criticalAngleDeg = (criticalAngleRad * 180) / Math.PI;
                criticalAngle.textContent = criticalAngleDeg.toFixed(1) + 'Â°';
                criticalAngleInfo.style.display = 'block';
            } else {
                criticalAngleInfo.style.display = 'none';
            }
        }
        
        function updateValues() {
            incidentAngle = parseFloat(incidentAngleSlider.value);
            drawRefraction();
        }
        
        function setupMaterialButtons() {
            // ä»‹è³ª1æŒ‰éˆ•
            const n1Buttons = document.querySelectorAll('[data-n1]');
            n1Buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    n1Buttons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    if (btn.dataset.n1 === 'custom') {
                        n1IsCustom = true;
                        n1Custom.style.display = 'inline';
                        n1 = parseFloat(n1Custom.value);
                    } else {
                        n1IsCustom = false;
                        n1Custom.style.display = 'none';
                        n1 = parseFloat(btn.dataset.n1);
                    }
                    
                    n1Value.textContent = n1.toFixed(2);
                    drawRefraction();
                });
            });
            
            // ä»‹è³ª2æŒ‰éˆ•
            const n2Buttons = document.querySelectorAll('[data-n2]');
            n2Buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    n2Buttons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    if (btn.dataset.n2 === 'custom') {
                        n2IsCustom = true;
                        n2Custom.style.display = 'inline';
                        n2 = parseFloat(n2Custom.value);
                    } else {
                        n2IsCustom = false;
                        n2Custom.style.display = 'none';
                        n2 = parseFloat(btn.dataset.n2);
                    }
                    
                    n2Value.textContent = n2.toFixed(2);
                    drawRefraction();
                });
            });
            
            // è‡ªå®šç¾©è¼¸å…¥æ¡†äº‹ä»¶
            n1Custom.addEventListener('input', () => {
                if (n1IsCustom) {
                    const value = parseFloat(n1Custom.value);
                    if (value >= 1.00 && value <= 2.00) {
                        n1 = value;
                        n1Value.textContent = n1.toFixed(2);
                        drawRefraction();
                    }
                }
            });
            
            n2Custom.addEventListener('input', () => {
                if (n2IsCustom) {
                    const value = parseFloat(n2Custom.value);
                    if (value >= 1.00 && value <= 2.00) {
                        n2 = value;
                        n2Value.textContent = n2.toFixed(2);
                        drawRefraction();
                    }
                }
            });
        }
        
        // äº‹ä»¶ç›£è½å™¨
        incidentAngleSlider.addEventListener('input', updateValues);
        
        // åˆå§‹åŒ–
        setupMaterialButtons();
        drawRefraction();
    </script>
</body>
</html>